Return-Path: <linux-pci-owner@vger.kernel.org>
X-Original-To: lists+linux-pci@lfdr.de
Delivered-To: lists+linux-pci@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 3BAD54419F0
	for <lists+linux-pci@lfdr.de>; Mon,  1 Nov 2021 11:32:09 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S232071AbhKAKeg (ORCPT <rfc822;lists+linux-pci@lfdr.de>);
        Mon, 1 Nov 2021 06:34:36 -0400
Received: from mail.kernel.org ([198.145.29.99]:36312 "EHLO mail.kernel.org"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S231949AbhKAKea (ORCPT <rfc822;linux-pci@vger.kernel.org>);
        Mon, 1 Nov 2021 06:34:30 -0400
Received: from disco-boy.misterjones.org (disco-boy.misterjones.org [51.254.78.96])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        by mail.kernel.org (Postfix) with ESMTPSA id 23AE860ED3;
        Mon,  1 Nov 2021 10:31:57 +0000 (UTC)
Received: from sofa.misterjones.org ([185.219.108.64] helo=why.misterjones.org)
        by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        (Exim 4.94.2)
        (envelope-from <maz@kernel.org>)
        id 1mhUbb-002qPl-0l; Mon, 01 Nov 2021 10:31:55 +0000
Date:   Mon, 01 Nov 2021 10:31:54 +0000
Message-ID: <878ry89nfp.wl-maz@kernel.org>
From:   Marc Zyngier <maz@kernel.org>
To:     Zhaoyu Liu <zackary.liu.pro@gmail.com>
Cc:     alyssa@rosenzweig.io, lorenzo.pieralisi@arm.com, robh@kernel.org,
        kw@linux.com, bhelgaas@google.com, linux-pci@vger.kernel.org,
        linux-kernel@vger.kernel.org
Subject: Re: [PATCH] pci/controller/pcie-apple: remove the indentation beside arguments of DECLARE_BITMAP
In-Reply-To: <20211031135544.GA1616@pc>
References: <20211031135544.GA1616@pc>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/27.1
 (x86_64-pc-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 185.219.108.64
X-SA-Exim-Rcpt-To: zackary.liu.pro@gmail.com, alyssa@rosenzweig.io, lorenzo.pieralisi@arm.com, robh@kernel.org, kw@linux.com, bhelgaas@google.com, linux-pci@vger.kernel.org, linux-kernel@vger.kernel.org
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false
Precedence: bulk
List-ID: <linux-pci.vger.kernel.org>
X-Mailing-List: linux-pci@vger.kernel.org

On Sun, 31 Oct 2021 13:55:48 +0000,
Zhaoyu Liu <zackary.liu.pro@gmail.com> wrote:
> 
> When "make tags", it prompts a warning:
> 
>     ctags: Warning: drivers/pci/controller/pcie-apple.c:150:
>     null expansion of name pattern "\1"
> 
> Ctags regular can not be matched due to indentation, so remove it.
> Same fix as in commit 5fdf876d30ce ("KVM: arm: Do not indent
> the arguments of DECLARE_BITMAP")
> 
> Signed-off-by: Zhaoyu Liu <zackary.liu.pro@gmail.com>
> ---
>  drivers/pci/controller/pcie-apple.c | 2 +-
>  1 file changed, 1 insertion(+), 1 deletion(-)
> 
> diff --git a/drivers/pci/controller/pcie-apple.c b/drivers/pci/controller/pcie-apple.c
> index b665d29af77a..955134464d84 100644
> --- a/drivers/pci/controller/pcie-apple.c
> +++ b/drivers/pci/controller/pcie-apple.c
> @@ -147,7 +147,7 @@ struct apple_pcie_port {
>  	void __iomem		*base;
>  	struct irq_domain	*domain;
>  	struct list_head	entry;
> -	DECLARE_BITMAP(		sid_map, MAX_RID2SID);
> +	DECLARE_BITMAP(sid_map, MAX_RID2SID);
>  	int			sid_map_sz;
>  	int			idx;
>  };

This really feels like we're papering over a tooling bug. Other
tagging systems do not seem to suffer from this (I use gtags myself).

It is easily fixed with the following patch, at least with my
setup. Can you please give it a go?

Thanks,

	M.

diff --git a/scripts/tags.sh b/scripts/tags.sh
index b24bfaec6290..7e5f19391f20 100755
--- a/scripts/tags.sh
+++ b/scripts/tags.sh
@@ -186,7 +186,7 @@ regex_c=(
 	'/\<DEFINE_\(RT_MUTEX\|MUTEX\|SEMAPHORE\|SPINLOCK\)(\([[:alnum:]_]*\)/\2/v/'
 	'/\<DEFINE_\(RAW_SPINLOCK\|RWLOCK\|SEQLOCK\)(\([[:alnum:]_]*\)/\2/v/'
 	'/\<DECLARE_\(RWSEM\|COMPLETION\)(\([[:alnum:]_]\+\)/\2/v/'
-	'/\<DECLARE_BITMAP(\([[:alnum:]_]*\)/\1/v/'
+	'/\<DECLARE_BITMAP([[:space:]]*\([[:alnum:]_]*\)/\1/v/'
 	'/\(^\|\s\)\(\|L\|H\)LIST_HEAD(\([[:alnum:]_]*\)/\3/v/'
 	'/\(^\|\s\)RADIX_TREE(\([[:alnum:]_]*\)/\2/v/'
 	'/\<DEFINE_PER_CPU([^,]*, *\([[:alnum:]_]*\)/\1/v/'


-- 
Without deviation from the norm, progress is not possible.
