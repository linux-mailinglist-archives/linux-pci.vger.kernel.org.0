Return-Path: <linux-pci+bounces-31093-lists+linux-pci=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-pci@lfdr.de
Delivered-To: lists+linux-pci@lfdr.de
Received: from ny.mirrors.kernel.org (ny.mirrors.kernel.org [IPv6:2604:1380:45d1:ec00::1])
	by mail.lfdr.de (Postfix) with ESMTPS id 52A6FAEE5A3
	for <lists+linux-pci@lfdr.de>; Mon, 30 Jun 2025 19:23:08 +0200 (CEST)
Received: from smtp.subspace.kernel.org (relay.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-ECDSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by ny.mirrors.kernel.org (Postfix) with ESMTPS id 8D5F8165256
	for <lists+linux-pci@lfdr.de>; Mon, 30 Jun 2025 17:23:08 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id F3B6F293C52;
	Mon, 30 Jun 2025 17:23:03 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=kernel.org header.i=@kernel.org header.b="ovAGC3m9"
X-Original-To: linux-pci@vger.kernel.org
Received: from smtp.kernel.org (aws-us-west-2-korg-mail-1.web.codeaurora.org [10.30.226.201])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id CBC4A286D6F;
	Mon, 30 Jun 2025 17:23:03 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=10.30.226.201
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1751304183; cv=none; b=jkDghe8b1sDZ10oHqkjWMAhDPjeACIBcmf3Wnl8WhErJnhvooTgyPvDkZH8s5rSKuDFcHXvm6lxT9B4CRXyLHw9dbUmaYaBDntEQBuptW/P+vJizlh7feqYMn1dXRNV7S15a5tH8/oORADTHYwOBNY/ArD6AJ2mup6Wf2l4YhHQ=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1751304183; c=relaxed/simple;
	bh=w15NJ/7DEmXwWaHvvIBuUtaQ5bXCQ49qvYa4CYdrJ3w=;
	h=Date:Message-ID:From:To:Cc:Subject:In-Reply-To:References:
	 MIME-Version:Content-Type; b=CUNU4K05gBCq3bgI0La0DkGgMMAdnBgyNPH6kNsmgzNMniFN5NiGMvPI123XkMhEhlzhHK3H0n/jHaUyG4rUhDR7xu8nId6iOYuIjA0/If7zLRdgpnEGFAfG13Sujo+lUYdgsI8X54hN2SAEzSExi0fo/m8Ru5M562gjtrQ6uF8=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dkim=pass (2048-bit key) header.d=kernel.org header.i=@kernel.org header.b=ovAGC3m9; arc=none smtp.client-ip=10.30.226.201
Received: by smtp.kernel.org (Postfix) with ESMTPSA id 31786C4CEE3;
	Mon, 30 Jun 2025 17:23:03 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
	s=k20201202; t=1751304183;
	bh=w15NJ/7DEmXwWaHvvIBuUtaQ5bXCQ49qvYa4CYdrJ3w=;
	h=Date:From:To:Cc:Subject:In-Reply-To:References:From;
	b=ovAGC3m9hCEDf7z8XhoEMS+86eLdhSN8xKRvinXQZXM+UKnJ9ru4EA7hvpRwrmxn7
	 QkoZEGSzoM8Far17Ebs4XO/8Guft6TtUul/p/djwqAv8+PUtpZSd97RfK89Jnag32a
	 ooFhe9orMaCf5hNHkw17dbpEO8dwTAiBoaLvj871pAVTNrYf0yLp/tguJau3+/2QND
	 7eG6NNlCBkMOXdRaWVZOwcwUi8uRJtvz4UzP61FoMVUakRWkTfaEffkKHUeqNpDVP+
	 wib2pk/PQ1v9mNr+LTNw89F6+nxG+vsPKXSq0ce7hcJWoORTAPD25/bKuBH/izLsJe
	 sT8a6wtyFsuIg==
Received: from sofa.misterjones.org ([185.219.108.64] helo=goblin-girl.misterjones.org)
	by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
	(Exim 4.95)
	(envelope-from <maz@kernel.org>)
	id 1uWIDc-00BK7Y-Ty;
	Mon, 30 Jun 2025 18:23:00 +0100
Date: Mon, 30 Jun 2025 18:23:00 +0100
Message-ID: <86ikkdb0uj.wl-maz@kernel.org>
From: Marc Zyngier <maz@kernel.org>
To: Bjorn Helgaas <helgaas@kernel.org>
Cc: Bjorn Helgaas <bhelgaas@google.com>,	Alyssa Rosenzweig
 <alyssa@rosenzweig.io>,	Rob Herring <robh@kernel.org>,	Manivannan
 Sadhasivam <mani@kernel.org>,	Lorenzo Pieralisi <lpieralisi@kernel.org>,
	Krzysztof =?UTF-8?B?V2lsY3p5xYRza2k=?= <kwilczynski@kernel.org>,	Janne
 Grunau <j@jannau.net>,	Geert Uytterhoeven <geert+renesas@glider.be>,
	linux-pci@vger.kernel.org,	linux-arm-kernel@lists.infradead.org,
	linux-riscv@lists.infradead.org,	linux-kernel@vger.kernel.org
Subject: Re: [PATCH 0/3] PCI: host-generic: Fix driver_data overwriting bugs
In-Reply-To: <20250630170601.GA1785925@bhelgaas>
References: <20250625111806.4153773-1-maz@kernel.org>
	<20250630170601.GA1785925@bhelgaas>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/30.1
 (aarch64-unknown-linux-gnu) MULE/6.0 (HANACHIRUSATO)
Precedence: bulk
X-Mailing-List: linux-pci@vger.kernel.org
List-Id: <linux-pci.vger.kernel.org>
List-Subscribe: <mailto:linux-pci+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-pci+unsubscribe@vger.kernel.org>
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 185.219.108.64
X-SA-Exim-Rcpt-To: helgaas@kernel.org, bhelgaas@google.com, alyssa@rosenzweig.io, robh@kernel.org, mani@kernel.org, lpieralisi@kernel.org, kwilczynski@kernel.org, j@jannau.net, geert+renesas@glider.be, linux-pci@vger.kernel.org, linux-arm-kernel@lists.infradead.org, linux-riscv@lists.infradead.org, linux-kernel@vger.kernel.org
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false

On Mon, 30 Jun 2025 18:06:01 +0100,
Bjorn Helgaas <helgaas@kernel.org> wrote:
> 
> On Wed, Jun 25, 2025 at 12:18:03PM +0100, Marc Zyngier wrote:
> > Geert reports that some drivers do rely on the device driver_data
> > field containing a pointer to the bridge structure at the point of
> > initialising the root port, while this has been recently changed to
> > contain some other data for the benefit of the Apple PCIe driver.
> > 
> > This small series builds on top of Geert previously posted (and
> > included as a prefix for reference) fix for the Microchip driver,
> > which breaks the Apple driver. This is basically swapping a regression
> > for another, which isn't a massive deal at this stage, as the
> > follow-up patch fixes things for the Apple driver by adding extra
> > tracking.
> 
> Is there a bisection hole between patches 1 and 2?
> 
>   1: PCI: host-generic: Set driver_data before calling gen_pci_init()
>   2: PCI: apple: Add tracking of probed root ports
> 
> If so, would it be practical to avoid the hole by reordering those
> patches?

Sure, but you said you already had queued patch #1, and what is in
-rc1 already breaks Geert's box. So no matter the order, we break
something at some point.

If you want to only break one thing, then yes, swapping these two
patches is the correct thing to do.

Thanks,

	M.

-- 
Without deviation from the norm, progress is not possible.

